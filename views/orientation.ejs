<!-- Add the necessary HTML, CSS, and JavaScript for the /orientation page -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TROOP ASSIGNMENT</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/fonts.css">
    
    <link rel="stylesheet" href="/css/orientation-styles.css">
    <link rel="stylesheet" href="/css/cutscene-styles.css">
</head>
<body>

    <section class="cutscene">
        <div class="container-fluid">
            <div class="logo-container">
                <h2>TRAINING MODULE 01</h2>
                <h1>AGENT PROFILE</h1>
            </div>
        </div>
    
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-2">
                    <video id="vid-1" width="320" height="240" class="hidden">
                        <source src="/images/01.webm" type="video/webm">
                    </video>

                    <button id="playPauseBtn">
                        <img src="/images/Play Button_Jarvis.png" alt="">
                    </button>
                </div>
                <div id="clickheretobegin" class="col-md-10">
                    <img src="/images/01 Onboarding.png" alt="">
                </div>
            </div>
        </div>
    </section>

    <section class="level hidden">
        <header>
            <nav class="navbar navbar-expand-lg">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#">
                        <img src="/images/logo.png" alt="Logo" class="logo">
                    </a>
                    <div class="title">
                        <h1>01</h1>
                        <h1>TROOP ASSIGNMENT</h1>
                    </div>
                    <div class="collapse navbar-collapse">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="/playerinfo">
                                    <img src="<%= user.playerAvatar %>" alt="Icon" class="icon">
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>
    
    
        <section class="intro-section">
            <div class="container">
                <div id="intro-section">
                    <img src="/images/orientationlogo.gif" alt="">
                    <p style="font-family: Lexend-Deca;">Thank you for joining Mission Renaissance.</p>
                    <p style="font-family: Lexend-Deca;"> Before we start your training, we need to assign you to a troop that aligns with your strengths and will help you grow. To determine the most suitable match, you will need to answer a series of questions. Please select the option that best aligns with your characteristics and preferences. Prepare yourself, and let's begin.</p>
                    <button id="begin-button" class="btn btn-warning" style="font-family: Lexend;">BEGIN</button>
                </div>
            </div>
        </section>
        
    
        <section class="questions-section hidden">
            <div class="container">
                <div class="question-wrapper">
                    <div id="question1" class="question hidden">
                        <div class="row">
                            <div class="col-md-2">
                                <img src="/images/orientationlogo.gif" alt="">
                            </div>
                            <div class="col-md-10">
                                <h1>1. Which of the following activities interest you the most?</h1>
                            </div>
                        </div>
                        <p class="answer" data-troop="T">A. Solving puzzles and analytical problems</p>
                        <p class="answer" data-troop="M">B. Learning new topics and expanding knowledge</p>
                        <p class="answer" data-troop="N">C. Creating or inventing new things</p>
                        <p class="answer" data-troop="E">D. Helping others and making a positive impact</p>
                    </div>
                </div>
                <div class="question-wrapper">
                    <div id="question2" class="question hidden">
                        <div class="row">
                            <div class="col-md-2">
                                <img src="/images/orientationlogo.gif" alt="">
                            </div>
                            <div class="col-md-10">
                                <h1>2. How do you approach learning new information or skills?</h1>
                            </div>
                        </div>
                        <p class="answer" data-troop="N">A. By brainstorming creative and unique approaches</p>
                        <p class="answer" data-troop="E">B. By collaborating with others and learning from their experiences.</p>
                        <p class="answer" data-troop="M">C. Through detailed research and studying past examples.</p>
                        <p class="answer" data-troop="T">D. By diving in and learning through doing.</p>
                    </div>
                </div>
                
                <div class="question-wrapper">
                    <div id="question3" class="question hidden">
                        <div class="row">
                            <div class="col-md-2">
                                <img src="/images/orientationlogo.gif" alt="">
                            </div>
                            <div class="col-md-10">
                                <h1>3. Your team needs to solve a complex problem with multiple possible solutions. How do you proceed?</h1>
                            </div>
                        </div>
                        <p class="answer" data-troop="N">A. Encourage team members to think out of the box and come up with innovative, previously unexplored ideas to solve the problem.</p>
                        <p class="answer" data-troop="M">B. Look into how similar problems were solved in the past and use those solutions as a guide, even if it means a slower initial response.</p>
                        <p class="answer" data-troop="E">C. Facilitate a brainstorming session to gather diverse perspectives and ideas before deciding on a solution.</p>
                        <p class="answer" data-troop="T">D. Break the problem into smaller, manageable parts and address each one as it arises, focusing on immediate issues.</p>
                    </div>
                </div>
                
                <div class="question-wrapper">
                    <div id="question4" class="question hidden">
                        <div class="row">
                            <div class="col-md-2">
                                <img src="/images/orientationlogo.gif" alt="">
                            </div>
                            <div class="col-md-10">
                                <h1>4. Please select the option that best describes your knowledge about AI; itâ€™s concepts, applications, and implications in today's world.</h1>
                            </div>
                        </div>
                        <p class="answer" data-troop="N">A. I've heard of AI and recognize its significance, but I haven't delved deeply into its specifics beyond its basic definition.</p>
                        <p class="answer" data-troop="M">B. I have a basic understanding of AI, know its general principles, and am aware of some applications in technology and industry.</p>
                        <p class="answer" data-troop="E">C. AI is relatively new to me, and I have limited knowledge or exposure to its concepts, applications, and societal impacts.</p>
                        <p class="answer" data-troop="T">D. I actively keep up with AI advancements, understand its core concepts, and follow its applications across various fields.</p>
                    </div>
                </div>
                
                <div class="question-wrapper">
                    <div id="question5" class="question hidden">
                        <div class="row">
                            <div class="col-md-2">
                                <img src="/images/orientationlogo.gif" alt="">
                            </div>
                            <div class="col-md-10">
                                <h1>5. Imagine AI seamlessly becoming part of your daily routines. Consider which of the following capabilities would you find most valuable</h1>
                            </div>
                        </div>
                        <p class="answer" data-troop="E">A. Enhancing your ability to interact and communicate with technology and services more naturally.</p>
                        <p class="answer" data-troop="N">B. Generating various types of entertainment such as live art, music, and immersive videos.</p>
                        <p class="answer" data-troop="T">C. Helping you make informed decisions by analyzing patterns in your daily activities and preferences.</p>
                        <p class="answer" data-troop="M">D. Offering tailored suggestions for optimizing your productivity, health, or leisure activities.</p>
                    </div>
                </div>
                
                <div class="question-wrapper">
                    <div id="question6" class="question hidden">
                        <div class="row">
                            <div class="col-md-2">
                                <img src="/images/orientationlogo.gif" alt="">
                            </div>
                            <div class="col-md-10">
                                <h1>6. Reflecting on the ongoing development of AI, what concerns you the most about its impact on society and daily life?</h1>
                            </div>
                        </div>
                        <p class="answer" data-troop="T">A. Job displacement due to automation and AI replacing human workers.</p>
                        <p class="answer" data-troop="N">B. AI's potential to surpass human intelligence and its implications for society.</p>
                        <p class="answer" data-troop="M">C. Privacy and security risks associated with AI collecting and analyzing personal data.</p>
                        <p class="answer" data-troop="E">D. Ethical dilemmas, such as AI making biased decisions or lacking accountability.</p>
                    </div>
                </div>
                
                <div class="question-wrapper">
                    <div id="question7" class="question hidden">
                        <div class="row">
                            <div class="col-md-2">
                                <img src="/images/orientationlogo.gif" alt="">
                            </div>
                            <div class="col-md-10">
                                <h1>7. If you needed assistance in writing a research paper, how would you prefer to receive help?</h1>
                            </div>
                        </div>
                        <p class="answer" data-troop="T">A. Provide the latest information and research relevant to your topic.</p>
                        <p class="answer" data-troop="M">B. Review your previous papers and writing style to ensure consistency and improvement.</p>
                        <p class="answer" data-troop="E">C. Gather feedback and suggestions from colleagues and academic forums.</p>
                        <p class="answer" data-troop="N">D. Explore newer methods of writing and research forms, and produce novel ideas.</p>
                    </div>
                </div>
                
            </div>
        </section>
    
        <section class="troop-section hidden">
            <div class="container">
                <div class="question-wrapper">
                    <div class="row box-design">
                        <div class="col-md-2">
                            <img src="/images/orientationlogo.gif" alt="">
                        </div>
                        <div class="col-md-10">
                            <h1>Great job! We've recorded all your answers and are now analyzing your unique traits. Hold tight as we assign you to the troop that best matches your skills and personality. This won't take long â€“ your adventure is about to begin!</h1>
                        </div>
                    </div>
                </div>
            </div>
    
            <div class="container" id="loading-container" class="hidden">
                <div class="question-wrapper">
                    <div class="box-design">
                        <img id="loading-gif" src="/images/LoadingChat.gif" alt="Loading...">
                    </div>
                </div>
            </div>
    
            <div class="container hidden" id="troop-info">
                <div class="question-wrapper">
                    <div class="box-design">
                        <div class="row">
                            <div class="col-md-2">
                                <img src="/images/orientationlogo.gif" alt="">
                            </div>
                            <div class="col-md-10">
                                <h1 id="troop-title"></h1>
                            </div>
                        </div>
                        <img id="troop-image" src="" alt="">
                        <p id="troop-description"></p>
                    </div>
                </div>
                
            </div>
    
        </section>
        
        <section class="avatar-section hidden">
            <div class="container">
                <div class="question-wrapper">
                    <div class="box-design">
                        <div class="row">
                            <div class="col-md-2">
                                <img class="profile-img" src="/images/orientationlogo.gif" alt="">
                            </div>
                            <div class="col-md-10">
                                <h1>Now that your troop has been chosen, it's time to pick your avatar. Select one from the below that best represents you</h1>
                            </div>
                        </div>
                        
                        <div class="row" id="avatar-container">
                            <!-- Avatar images will be added here dynamically -->
                        </div>
                        <div class="btn-container">
                            <button id="submit-avatar-button" class="btn btn-warning hidden" style="font-family: Lexend;">Choose</button>
                        </div>
                    </div>
                </div>  
            </div>
        </section>
    
        <div class="level-end-container hidden">
            <div class="container">
                <div id="level-end-message"></div>
            </div>
        </div>
        
        <section class="footer-section hidden">
            <div id="footer-section-text">
                <div class="container">
                    <div class="question-wrapper">
                        <div class="box-design">
                            <div class="row">
                                <div class="col-md-2">
                                    <img class="profile-img" src="/images/orientationlogo.gif" alt="">
                                </div>
                                <div class="col-md-10">
                                    <h1>Great choice! Your Agent Profile has been successfully generated. Please check the â€˜Profileâ€™ tab to view the details of your assigned troop and your profile information. Welcome to Mission Renaissance, and best of luck on your journey!</h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="container">
                <div class="btn-container" style="margin-bottom: 4%;">
                    <a href="/playerinfo" class="btn btn-warning" style="font-family: Lexend;">Next</a>
                </div>
                
            </div>
            
        </section>
    </section>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    

    <script>

        const troopData = {
            'Tempus': {troop: 'Tempus', title: 'Welcome to Troop Tempus, where logic reigns supreme and precision is the key to mastery! This troop holds quick thinkers and efficient problem-solvers. ', image: '/images/tempus.png', description: 'Here, we thrive in the moment, making swift and decisive actions to tackle challenges head-on.  With your keen adaptability and exceptional time management skills, you are now part of a group that excels under pressure and adapts to changing circumstances with ease. Our members are known for their methodical approach and eagle-eyed attention to detail, transforming chaos into order with every calculation. Together, we will harness the power of the present to achieve great things. ' },
            'Empathia': {troop: 'Empathia', title: 'Welcome to Troop Empathia, where  ethics and human-centered design take center stage! This is where innovators combine their empathy for humanity to drive solutions.', image: '/images/empathia.png', description: 'Here, we understand and predict human behavior, fostering strong connections and collaboration. Your high emotional intelligence, empathy, and excellent communication skills make you an invaluable member of our troop. Our members are champions of responsible AI, always considering the societal impacts and striving to ensure that tech innovations serve the greater good. Together, we will bridge hearts and minds, creating a harmonious and understanding environment where everyone can thrive. ' },
            'Neurona': {troop: 'Neurona', title: 'Welcome to Troop Neurona, the realm of limitless creativity and boundless innovation! This is where the dreamers and trailblazers unite, and unleash their inner creativity.', image: '/images/neurona.png', description: 'Here, we combine the flair of an artist and the curiosity of an explorer. Neurona is your canvas to paint groundbreaking technologies and inventive ideas, making the impossible possible. Our members are the visionaries who see connections where others see chaos, turning sparks of inspiration into dazzling realities. If you thrive on thinking outside the box and love to experiment with new ideas, Neurona is your stage. Let your imagination soar, because in Neurona, every thought can become a masterpiece!' },
            'Memoria': {troop: 'Memoria', title: 'Welcome to Troop Memoria, the sanctuary of wisdom, knowledge, and the pursuit of lifelong learning!  This troop gathers deep thinkers and strategic planners.', image: '/images/memoria.png', description: 'Here, we learn from the past to inform our actions in the present and shape a better future. Your analytical thinking, research prowess, and ability to draw insights from historical data make you a perfect fit for this house. Memoria a treasure trove of insights and discoveries, where every question leads to a new revelation. Together, we will delve into the depths of knowledge, uncovering patterns and crafting strategies that stand the test of time.' },
        };

        const userId = '<%= userId %>';

        const video = document.getElementById('vid-1');
        const playPauseBtn = document.getElementById('playPauseBtn');

        // Play/Pause functionality
        playPauseBtn.addEventListener('click', () => {
            if (video.paused || video.ended) {
                video.play();
                playPauseBtn.style.display = 'none';

                playPauseBtn.classList.add("hidden");
                video.classList.remove("hidden");
            }
        });

        document.addEventListener('DOMContentLoaded', () => {

            const beginButton = document.getElementById('begin-button');
            const firstQuestion = document.getElementById('question1');
            const introSection = document.getElementById('intro-section');
            var troopInfo = [];

            document.getElementById("clickheretobegin").addEventListener('click', function(event) {
                document.querySelector(".cutscene").classList.add("hidden");
                document.querySelector(".level").classList.remove("hidden");
            }, { once: true });

            beginButton.addEventListener('click', () => {
                // Remove the 'hidden' class from the first question
                document.querySelector('.questions-section').classList.remove('hidden');
                firstQuestion.classList.remove('hidden');
                autoScroll();
            });

            const questions = document.querySelectorAll('.question');
            let currentQuestionIndex = 0;

            function handleAnswerClick(event) {
                const answerElement = event.target;
                if (answerElement.classList.contains('answer')) {
                    const answerText = answerElement.textContent.trim();
                    const troopValue = answerElement.getAttribute('data-troop');

                    answerElement.classList.add('selected');

                    // Perform the POST request
                    fetch('/orientation/submit-answer', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({userId, answerText, troopValue }),
                    })
                    .then(response => {
                        if (response.ok) {
                            const playerChoiceElement = document.createElement('p');
                            playerChoiceElement.className = 'player-choice';
                            playerChoiceElement.textContent = `${answerText}`;

                            const questionWrapper = questions[currentQuestionIndex].closest('.question-wrapper');

                            questionWrapper.insertAdjacentElement('afterend', playerChoiceElement);

                            questions[currentQuestionIndex].style.pointerEvents = 'none';

                            currentQuestionIndex += 1;

                            if (currentQuestionIndex < questions.length) {
                                questions[currentQuestionIndex].classList.remove('hidden');
                                autoScroll();
                            } else {
                                fetch('/orientation/complete', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({ userId })
                                })
                                .then(response => response.json())
                                .then(data => {
                                    const troopSection = document.querySelector('.troop-section');
                                    const troopTitle = document.getElementById('troop-title');
                                    const troopImage = document.getElementById('troop-image');
                                    const troopDescription = document.getElementById('troop-description');  
                                    const loadingContainer = document.getElementById('loading-container');
                                    const troopInfoContainer = document.getElementById('troop-info');

                                    troopInfo = troopData[data.troopName];
                                    troopTitle.textContent = troopInfo.title;
                                    troopImage.src = troopInfo.image;
                                    troopDescription.textContent = troopInfo.description;

                                    const avatarContainer = document.getElementById('avatar-container');
                                    avatarContainer.innerHTML = ''; // Clear existing avatars

                                    data.avatars.forEach((avatar, index) => {
                                        const colDiv = document.createElement('div');
                                        colDiv.className = 'col-md-4';
                                        const img = document.createElement('img');
                                        img.src = avatar;
                                        img.alt = `Avatar ${index + 1}`;
                                        img.className = 'avatar';
                                        img.style.cursor = 'pointer';
                                        img.addEventListener('click', () => {
                                            document.querySelectorAll('.avatar').forEach(avatar => {
                                                avatar.classList.remove('selected');
                                            });
                                            img.classList.add('selected');
                                            selectedAvatar = avatar;
                                            document.getElementById('submit-avatar-button').classList.remove('hidden');
                                        });
                                        colDiv.appendChild(img);
                                        avatarContainer.appendChild(colDiv);
                                    });

                                    troopSection.classList.remove('hidden');
                                    autoScroll();

                                    setTimeout(() => {
                                        loadingContainer.classList.remove('hidden');
                                        autoScroll();
                                    }, 500); 

                                    setTimeout(() => {
                                        loadingContainer.classList.add('hidden'); 
                                        troopInfoContainer.classList.remove('hidden'); 
                                        autoScroll();
                                    }, 4500);
                                    
                                    setTimeout(() => {
                                        document.querySelector('.avatar-section').classList.remove('hidden');
                                        autoScroll();
                                    }, 10000);

                                })
                                .catch(error => console.error('Error:', error));
                            }
                        } else {
                            // Handle the error
                            console.error('Failed to submit answer');
                        }
                    })
                    .catch(error => {
                        // Handle network or other errors
                        console.error('Error:', error);
                    });
                }
            }

            // Add event listeners to answer options
            questions.forEach(question => {
                question.addEventListener('click', handleAnswerClick);
            });

            document.getElementById('submit-avatar-button').addEventListener('click', () => {
                if (selectedAvatar) {
                    fetch('/orientation/updateTroop', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ userId, troopName: troopInfo.troop, avatar: selectedAvatar })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.message === 'Troop and avatar updated') {
                            const playerChoiceElement = document.createElement('img');
                            playerChoiceElement.className = 'player-choice-img';
                            playerChoiceElement.src = `${selectedAvatar}`;

                            document.getElementById('level-end-message').appendChild(playerChoiceElement);

                            document.querySelector('.level-end-container').classList.remove('hidden');

                            document.querySelector('.footer-section').classList.remove('hidden');
                            autoScroll();
                        }
                    })
                    .catch(error => console.error('Error:', error));
                } else {
                    alert('Please select an avatar before submitting.');
                }
            });            

            function autoScroll() {
                window.scrollBy({
                    top: 800, // Adjust the scroll amount as needed
                    behavior: 'smooth'
                });
            }
        });
    </script>
</body>
</html>
